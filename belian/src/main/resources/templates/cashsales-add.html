<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity3">
<head>
	<meta charset="UTF-8"/>
	<title>Cash Sales Form</title>
	<th:block th:include="static"/>
	<th:block th:include="script"/>
	<script th:inline="javascript">
		/*<![CDATA[*/
			$(function(){
				$("#addline").click(function(){
					$("#form").attr('action','/cashsales/preadd/addline');
					$("#form").submit();
				});
			
				$(".removeline").click(function(){
					$("#form").attr('action','/cashsales/preadd/removeline/'+$(this).attr('index'));
					$("#form").submit();
				});
			
				$("#currency").click(function(){
					$.get('/currencysrest/load/'+$(this).val(),function(obj){
						$('#currencyCode').val(obj.code);
					});
				});
				
				$("#owner").click(function(){
					$.get('/partysrest/load/'+$(this).val(),function(obj){
						$('#ownerName').val(obj.name);
					});
				});
			});
		/*]]>*/
	</script>
</head>
<body>
	<th:block th:include="menu"/>
	<div class="content ui-widget-content">
		<fieldset>
		<div class="rcrumbs" id="breadcrumbs">
        	<ul>
            	<li><a th:href="@{/cashsales/list}">Cash Sales Management</a><span class="divider">></span></li>
            	<li><a>Form</a></li>
        	</ul>
        </div>
		<form id="form" class="pure-form pure-form-aligned" th:action="@{/cashsales/add}" method="post" th:object="${cashsales}">
			<div class="pure-control-group">
				<label>Date</label>
				<input type="date" class="dates" th:field="*{date}"/>
			</div>
			<div class="pure-control-group">
				<label>Company</label>
				<select id="company" th:field="*{companyId}">
					<option value="" selected="selected"></option>
					<option th:each="company:${companys}" th:value="${company.id}" th:text="${company.name}"/>
				</select>
				<input id="companyName" type="hidden" th:field="*{companyName}"/>
			</div>
			<div class="pure-control-group">
				<label>Sales</label>
				<select id="sales" th:field="*{salesId}">
					<option value="" selected="selected"></option>
					<option th:each="sales:${saleses}" th:value="${sales.id}" th:text="${sales.name}"/>
				</select>
				<input id="salesName" type="hidden" th:field="*{salesName}"/>
			</div>
			<div class="pure-control-group">
				<label>Customer</label>
				<select id="customer" th:field="*{customerId}">
					<option value="" selected="selected"></option>
					<option th:each="customer:${customers}" th:value="${customer.id}" th:text="${customer.name}"/>
				</select>
				<input id="customerName" type="hidden" th:field="*{customerName}"/>
			</div>
			<div class="pure-control-group">
				<label>Cash Account</label>
				<select id="account" th:field="*{payment.cashAccountId}">
					<option value="" selected="selected"></option>
					<option th:each="account:${accounts}" th:value="${account.id}" th:text="${account.name}"/>
				</select>
				<input id="cashAccountName" type="hidden" th:field="*{payment.cashAccountName}"/>
				<input id="cashAccountNumber" type="hidden" th:field="*{payment.cashAccountNumber}"/>
			</div>
			<br/>
			<div><a id="addline" style="cursor: pointer;">New Line</a></div>
			<table class="pure-table pure-table-bordered pure-table-striped">
		    <thead>
		    <tr>
		    	<th>Product</th>
		    	<th>Quantity</th>
		    	<th>&nbsp;</th>
		    </tr>
		    </thead>
		    <tbody>
			<tr th:each="line,stat:*{items}">
				<td>
					<select th:field="*{items[__${stat.index}__].inventoryId}">
						<option th:each="item:${inventorys}" th:value="${item.id}" th:text="${item.productName}"/>
					</select>
				</td>
		        <td>
		        	<input th:field="*{items[__${stat.index}__].quantity}"/>
		        </td>
		        <td>
		        	<input type="hidden" th:field="*{items[__${stat.index}__].id}"/>
		        	<a style="cursor: pointer;" class="removeline ui-icon ui-icon-trash" th:attr="index=${line.id}">Delete</a>
		        </td>
		    </tr>
		    </tbody>
		    </table>
			<div class="pure-controls">
				<button type="submit" autofocus="autofocus" class="pure-button pure-button-primary">Save</button>
			</div>
		</form>
		</fieldset>
	</div>
	<th:block th:include="footer"/>
	<th:block th:include="dialog"/>
</body>
</html>